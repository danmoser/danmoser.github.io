<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<title>codes_usage.rst</title>
<style type="text/css">

/*body {
   width: 1000px;
   margin-left: auto;
   margin-right: auto;
}
*/
table {
    margin: 0 auto;
    text-align: center;
    border-collapse: collapse;
    vertical-align: center;
    valig: center;
}

th,
td {
    padding: 5px;
    vertical-align: middle;
    /*text-align: left;*/
    /*border-bottom: 1px solid #ddd;*/
}

tr:nth-child(even) {
    background-color: #e6e6e6
}

tr:hover {
    background-color: #bfbfbf
}

.strike {
  text-decoration: line-through;
}

p {
    max-width: 1000px;
    text-align: justify;
    text-justify: inter-word;
} 

li {
    max-width: 1000px;
    text-align: justify;
    text-justify: inter-word;
}

.center {
    text-align: center;
}

</style>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7952 2016-07-26 18:15:59Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

.subscript {
  vertical-align: sub;
  font-size: smaller }

.superscript {
  vertical-align: super;
  font-size: smaller }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left, table.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right, table.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

table.align-center {
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

.align-top    {
  vertical-align: top }

.align-middle {
  vertical-align: middle }

.align-bottom {
  vertical-align: bottom }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
<style type="text/css">

/*
*   math2html: convert LaTeX equations to HTML output.
*
*   Copyright (C) 2009,2010 Alex Fernández
*                 2021      Günter Milde
*
*   Released under the terms of the `2-Clause BSD license'_, in short:
*   Copying and distribution of this file, with or without modification,
*   are permitted in any medium without royalty provided the copyright
*   notice and this notice are preserved.
*   This file is offered as-is, without any warranty.
*
* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause
*
*   Based on eLyXer: convert LyX source files to HTML output.
*   http://elyxer.nongnu.org/
*
*
* CSS file for LaTeX formulas.
*
* References: http://www.zipcon.net/~swhite/docs/math/math.html
*             http://www.cs.tut.fi/~jkorpela/math/
*/

/* Formulas */
.formula {
	text-align: center;
	margin: 1.2em 0;
	line-height: 1.4;
}
span.formula {
	white-space: nowrap;
}
div.formula {
	padding: 0.5ex;
	margin-left: auto;
	margin-right: auto;
}

/* Basic features */
a.eqnumber {
	display: inline-block;
	float: right;
	clear: right;
	font-weight: bold;
}
span.unknown {
	color: #800000;
}
span.ignored, span.arraydef {
	display: none;
}
.phantom {
	visibility: hidden;
}
.formula i {
	letter-spacing: 0.1ex;
}

/* Alignment */
.align-left, .align-l {
	text-align: left;
}
.align-right, .align-r {
	text-align: right;
}
.align-center, .align-c {
	text-align: center;
}

/* Structures */
span.hspace {
	display: inline-block;
}
span.overline, span.bar {
	text-decoration: overline;
}
.fraction, .fullfraction, .textfraction {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
}
span.formula .fraction,
.textfraction,
span.smallmatrix {
	font-size: 80%;
	line-height: 1;
}
span.numerator {
	display: block;
	line-height: 1;
}
span.denominator {
	display: block;
	line-height: 1;
	padding: 0ex;
	border-top: thin solid;
}
.formula sub, .formula sup {
	font-size: 80%;
}
sup.numerator, sup.unit {
	vertical-align: 80%;
}
sub.denominator, sub.unit {
	vertical-align: -20%;
}
span.smallsymbol {
	font-size: 75%;
	line-height: 75%;
}
span.boldsymbol {
	font-weight: bold;
}
span.sqrt {
	display: inline-block;
	vertical-align: middle;
	padding: 0.1ex;
}
sup.root {
	position: relative;
	left: 1.4ex;
}
span.radical {
	display: inline-block;
	padding: 0ex;
	/* font-size: 160%; for DejaVu, not required with STIX */
	line-height: 100%;
	vertical-align: top;
	vertical-align: middle;
}

span.root {
	display: inline-block;
	border-top: thin solid;
	padding: 0ex;
	vertical-align: middle;
}
div.formula .bigoperator,
.displaystyle .bigoperator,
.displaystyle .bigoperator {
	line-height: 120%;
	font-size: 140%;
	padding-right: 0.2ex;
}
span.fraction .bigoperator,
span.scriptstyle .bigoperator {
	line-height: inherit;
	font-size: inherit;
	padding-right: 0;
}
span.bigdelimiter {
	display: inline-block;
}
span.bigdelimiter.size1 {
	transform: scale(1, 1.2);
	line-height: 1.2;
}
span.bigdelimiter.size2 {
	transform: scale(1, 1.62);
	line-height: 1.62%;

}
span.bigdelimiter.size3 {
	transform: scale(1, 2.05);
	line-height: 2.05%;
}
span.bigdelimiter.size4 {
	transform: scale(1, 2.47);
	line-height: 2.47%;
}
/* vertically stacked sub and superscript */
span.scripts {
	display: inline-table;
	vertical-align: middle;
	padding-right: 0.2ex;
}
.script {
	display: table-row;
	text-align: left;
	line-height: 150%;
}
span.limits {
	display: inline-table;
	vertical-align: middle;
}
.limit {
	display: table-row;
	line-height: 99%;
}
sup.limit, sub.limit {
	line-height: 100%;
}
span.embellished,
span.embellished > .base {
	display: inline-block;
}
span.embellished > sup,
span.embellished > sub {
	display: inline-block;
	font-size: 100%;
	position: relative;
	bottom: 0.3em;
	width: 0px;
}
span.embellished > sub {
	top: 0.4em;
}

/* Environments */
span.array, span.bracketcases, span.binomial, span.environment {
	display: inline-table;
	text-align: center;
	vertical-align: middle;
}
span.arrayrow, span.binomrow {
	display: table-row;
	padding: 0;
	border: 0;
}
span.arraycell, span.bracket, span.case, span.binomcell, span.environmentcell {
	display: table-cell;
	padding: 0ex 0.2ex;
	line-height: 1; /* 99%; */
	border: 0ex;
}
.environment.align > .arrayrow > .arraycell.align-l {
	padding-right: 2em;
}

/* Inline binomials */
span.binom {
	display: inline-block;
	vertical-align: middle;
	text-align: center;
	font-size: 80%;
}
span.binomstack {
	display: block;
	padding: 0em;
}

/* Over- and underbraces */
span.overbrace {
	border-top: 2pt solid;
}
span.underbrace {
	border-bottom: 2pt solid;
}

/* Stackrel */
span.stackrel {
	display: inline-block;
	text-align: center;
}
span.upstackrel {
	display: block;
	padding: 0em;
	font-size: 80%;
	line-height: 64%;
	position: relative;
	top: 0.15em;

}
span.downstackrel {
	display: block;
	vertical-align: bottom;
	padding: 0em;
}

/* Fonts */
.formula {
	font-family: STIX, "DejaVu Serif", "DejaVu Math TeX Gyre", serif;
}
span.radical,   /* ensure correct size of square-root sign */
span.integral { /* upright integral signs for better alignment of indices */
	font-family: "STIXIntegralsUp", STIX;
	/* font-size: 115%; match apparent size with DejaVu */
}
span.bracket {
  /* some "STIX" and "DejaVu Math TeX Gyre" bracket pieces don't fit */
	font-family: "DejaVu Serif", serif;
}
span.mathsf, span.textsf {
	font-family: sans-serif;
}
span.mathrm, span.textrm {
	font-family: STIX, "DejaVu Serif", "DejaVu Math TeX Gyre", serif;
}
span.mathtt, span.texttt {
	font-family: monospace;
}
span.text, span.textnormal,
span.mathsf, span.mathtt, span.mathrm {
	font-style: normal;
}
span.fraktur {
	font-family: "Lucida Blackletter", eufm10, blackletter;
}
span.blackboard {
	font-family: Blackboard, msbm10, serif;
}
span.scriptfont {
	font-family: "Monotype Corsiva", "Apple Chancery", "URW Chancery L", cursive;
	font-style: italic;
}
span.mathscr {
  font-family: MathJax_Script, rsfs10,  cursive;
  font-style: italic;
}
span.textsc {
	font-variant: small-caps;
}
span.textsl {
	font-style: oblique;
}

/* Colors */
span.colorbox {
	display: inline-block;
	padding: 5px;
}
span.fbox {
	display: inline-block;
	border: thin solid black;
	padding: 2px;
}
span.boxed, span.framebox {
	display: inline-block;
	border: thin solid black;
	padding: 5px;
}

</style>
</head>
<body class="with-toc">
<main>


<p>Codes Usage</p>
<nav class="contents" id="table-of-contents" role="doc-toc">
<p class="topic-title">Table of contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#general" id="toc-entry-1">General</a></p></li>
<li><p><a class="reference internal" href="#hdust" id="toc-entry-2">Hdust</a></p>
<ul>
<li><p><a class="reference internal" href="#flags" id="toc-entry-3">Flags</a></p></li>
<li><p><a class="reference internal" href="#computational-time" id="toc-entry-4">Computational time</a></p></li>
<li><p><a class="reference internal" href="#bugs" id="toc-entry-5">Bugs</a></p></li>
<li><p><a class="reference internal" href="#mesocentre" id="toc-entry-6">Mesocentre</a></p>
<ul>
<li><p><a class="reference internal" href="#old-2017-and-before" id="toc-entry-7">Old (2017 and before)</a></p>
<ul>
<li><p><a class="reference internal" href="#running-times" id="toc-entry-8">Running times</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#precalcs" id="toc-entry-9"><span class="docutils literal">precalcs</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#tlusty-synspec" id="toc-entry-10">Tlusty + Synspec</a></p>
<ul>
<li><p><a class="reference internal" href="#kurucz" id="toc-entry-11">Kurucz</a></p></li>
<li><p><a class="reference internal" href="#hdust-pro" id="toc-entry-12">hdust.pro</a></p></li>
<li><p><a class="reference internal" href="#synspec-synplot" id="toc-entry-13">Synspec + Synplot</a></p>
<ul>
<li><p><a class="reference internal" href="#synspec" id="toc-entry-14">Synspec</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#vartools" id="toc-entry-15">VARTOOLS</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-help-commands" id="toc-entry-16">Basic/help commands</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-rms" id="toc-entry-17">Basic RMS</a></p></li>
<li><p><a class="reference internal" href="#basic-list-rms" id="toc-entry-18">Basic list RMS</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#site-examples" id="toc-entry-19">Site examples</a></p>
<ul>
<li><p><a class="reference internal" href="#fitting-a-quadratic-polynomial-in-jd-to-a-list-of-light-curves" id="toc-entry-20">Fitting a quadratic polynomial in JD to a list of light curves</a></p></li>
<li><p><a class="reference internal" href="#performing-a-lomb-scargle-period-search-on-a-light-curve-and-fitting-a-harmonic-series-to-the-light-curve" id="toc-entry-21">Performing a Lomb-Scargle period search on a light curve and fitting a harmonic series to the light curve</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#amdlib" id="toc-entry-22">amdlib</a></p>
<ul>
<li><p><a class="reference internal" href="#install" id="toc-entry-23">Install</a></p></li>
<li><p><a class="reference internal" href="#running" id="toc-entry-24">Running</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#compiling-tips" id="toc-entry-25">compiling tips</a></p>
<ul>
<li><p><a class="reference internal" href="#general-1" id="toc-entry-26">General</a></p>
<ul>
<li><p><a class="reference internal" href="#ld-cannot-find-lm" id="toc-entry-27"><span class="docutils literal">ld: cannot find <span class="pre">-lm</span></span></a></p></li>
<li><p><a class="reference internal" href="#what-libraries-are-being-used-during-compile" id="toc-entry-28">What libraries are being used during compile?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cmake" id="toc-entry-29"><span class="docutils literal">cmake</span></a></p>
<ul>
<li><p><a class="reference internal" href="#customize-cmake-options" id="toc-entry-30">Customize <span class="docutils literal">cmake</span> options</a></p></li>
<li><p><a class="reference internal" href="#is-there-an-uninstall-for-cmake-install" id="toc-entry-31">Is there an &quot;uninstall&quot; for cmake install?</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#usp-rice" id="toc-entry-32">USP-Rice</a></p>
<ul>
<li><p><a class="reference internal" href="#antigo-usando-os-recursos-rice" id="toc-entry-33">Antigo (Usando os recursos Rice)</a></p>
<ul>
<li><p><a class="reference internal" href="#usando-o-bg-p" id="toc-entry-34">Usando o BG/P</a></p></li>
<li><p><a class="reference internal" href="#compilando" id="toc-entry-35">Compilando</a></p></li>
<li><p><a class="reference internal" href="#queues-running" id="toc-entry-36">Queues + Running</a></p></li>
<li><p><a class="reference internal" href="#tests" id="toc-entry-37">Tests</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usando-os-recursos-rice-ii-set-2015-jan-2016" id="toc-entry-38">Usando os recursos Rice II - Set/2015-Jan/2016</a></p>
<ul>
<li><p><a class="reference internal" href="#inscricao" id="toc-entry-39">Inscrição</a></p></li>
<li><p><a class="reference internal" href="#primeiros-passos" id="toc-entry-40">Primeiros passos</a></p></li>
<li><p><a class="reference internal" href="#exemplo-transferencia-de-arquivos" id="toc-entry-41">Exemplo transferencia de arquivos</a></p></li>
<li><p><a class="reference internal" href="#compilando-e-ajustando" id="toc-entry-42">Compilando e ajustando</a></p></li>
<li><p><a class="reference internal" href="#queues-running-1" id="toc-entry-43">Queues + Running</a></p></li>
<li><p><a class="reference internal" href="#testes" id="toc-entry-44">Testes</a></p></li>
<li><p><a class="reference internal" href="#additional-user-support-on-the-bg" id="toc-entry-45">Additional User Support on the BG</a></p></li>
<li><p><a class="reference internal" href="#extra" id="toc-entry-46">Extra</a></p></li>
<li><p><a class="reference internal" href="#outros-recursos" id="toc-entry-47">Outros recursos</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="general">
<h2><a class="toc-backref" href="#toc-entry-1" role="doc-backlink">General</a></h2>
<ul class="simple">
<li><p>A few programming languages use a “defer” pattern for resource cleanup: <a class="reference external" href="https://kevincox.ca/2022/05/13/wrong-by-default/">https://kevincox.ca/2022/05/13/wrong-by-default/</a></p></li>
<li><p>GCC environment variables: <a class="reference external" href="https://gcc.gnu.org/onlinedocs/gcc/Environment-Variables.html">https://gcc.gnu.org/onlinedocs/gcc/Environment-Variables.html</a></p></li>
</ul>
</section>
<section id="hdust">
<h2><a class="toc-backref" href="#toc-entry-2" role="doc-backlink">Hdust</a></h2>
<section id="flags">
<h3><a class="toc-backref" href="#toc-entry-3" role="doc-backlink">Flags</a></h3>
<table>
<thead>
<tr><th class="head"><p>Compiler</p></th>
<th class="head"><p>FC (s)</p></th>
<th class="head"><p>CFLAGS (s)</p></th>
<th class="head"><p>FC (par)</p></th>
<th class="head"><p>CFLAGS (par)</p></th>
<th class="head"><p>clusters</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>intel</p></td>
<td><p>ifort</p></td>
<td><p>-132</p></td>
<td><p>mpif90</p></td>
<td><p>-132 -xHost -O3 -ipo -no-prec-div</p></td>
<td><p>acrux, lical</p></td>
</tr>
<tr><td><p>path_scale</p></td>
<td><p>pathf95</p></td>
<td><p></p></td>
<td><p>mpif90</p></td>
<td><p>-apo -Ofast</p></td>
<td><p>projekct</p></td>
</tr>
<tr><td><p>gfortran</p></td>
<td><p>gfortran</p></td>
<td><p></p></td>
<td><p>mpif90</p></td>
<td><p>-O2</p></td>
<td><p>acrux</p></td>
</tr>
</tbody>
</table>
</section>
<section id="computational-time">
<h3><a class="toc-backref" href="#toc-entry-4" role="doc-backlink">Computational time</a></h3>
<table>
<thead>
<tr><th class="head"><p>Step</p></th>
<th class="head"><p>n_f</p></th>
<th class="head"><p>time (min)</p></th>
<th class="head"><p>ncr</p></th>
<th class="head"><p><span class="formula">Σ<sub>0</sub></span></p></th>
<th class="head"><p>n_proc</p></th>
</tr>
</thead>
<tbody>
<tr><td><p>1</p></td>
<td><p>2.5e6</p></td>
<td><p>1.5</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>48</p></td>
</tr>
<tr><td><p>1</p></td>
<td><p>2.5e7</p></td>
<td><p>15</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>48</p></td>
</tr>
<tr><td><p>1</p></td>
<td><p>2.0e7</p></td>
<td><p>53</p></td>
<td><p>40</p></td>
<td><p>?</p></td>
<td><p>48</p></td>
</tr>
<tr><td><p>1</p></td>
<td><p>7.5e8</p></td>
<td><p>390</p></td>
<td><p>40</p></td>
<td><p>?</p></td>
<td><p>48</p></td>
</tr>
<tr><td><p>5, Sob 1</p></td>
<td><p>5.0e6</p></td>
<td><p>3</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>48</p></td>
</tr>
<tr><td><p>5, Sob 1</p></td>
<td><p>5.0e7</p></td>
<td><p>30</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>48</p></td>
</tr>
<tr><td><p>5, Sob 0</p></td>
<td><p>2.0e7</p></td>
<td><p>2</p></td>
<td><p>?</p></td>
<td><p>?</p></td>
<td><p>48</p></td>
</tr>
</tbody>
</table>
<p>Valores para teste (execução em aprox. 1 min em <span class="docutils literal">mpirun <span class="pre">-np</span> 3</span>):</p>
<ul class="simple">
<li><p>step1: 30000</p></li>
<li><p>SED: 500000 (Sob 0)</p></li>
<li><p>Ha: 50000 (Sob 1)</p></li>
<li><p>com poeira: 520 (Sob 1; teste para Cesar em 2016-06-17, gridBBre)</p></li>
<li><p>(valores podem variar de até um fator 1/2 ou 2, dependendo dos parâmetros e máquina usada).</p></li>
</ul>
</section>
<section id="bugs">
<h3><a class="toc-backref" href="#toc-entry-5" role="doc-backlink">Bugs</a></h3>
<p>Afirmação de 17/06/2013: <span class="docutils literal">NaN</span> não é um problemas de compilador ou cluster. Resultados idẽnticos no cluster projekct e na alphacrucis.</p>
<pre class="code literal-block"><code>forrtl: severe (408): fort: (18): Dummy character variable 'MODE' has length 5 which is greater than actual variable length 1</code></pre>
<p>Na versão serial: ocorre devido a flag <span class="docutils literal"><span class="pre">-C</span></span> na compilação.</p>
<pre class="code literal-block"><code>forrtl: severe (71): integer divide by zero</code></pre>
<p>Na versão paralela: ocorre devido a um arquivo mal especificado no input!</p>
<pre class="code literal-block"><code>Program received signal SIGFPE: Floating point...

Backtrace for this error:</code></pre>
<p>Na versão paralela: ocorre devido a um ausência do mpirun no comando de execução!</p>
</section>
<section id="mesocentre">
<h3><a class="toc-backref" href="#toc-entry-6" role="doc-backlink">Mesocentre</a></h3>
<p>Comandos:</p>
<pre class="code bash literal-block"><code>ssh <span class="name variable">$USER</span>&#64;ssh-n.oca.eu
ssh <span class="name variable">$USER</span>&#64;licallo.oca.eu

<span class="comment single"># Tunel por uma porta:
</span><span class="name builtin">alias</span> <span class="name variable">lical</span><span class="operator">=</span><span class="literal string double">&quot;echo '# Redirecting licallo to port 7025...'; ssh -l </span><span class="name variable">$USER</span><span class="literal string double"> -L 7025:licallo.oca.eu:22 ssh-n.oca.eu -N&quot;</span>

<span class="comment single"># Copiar arquivos:
</span>scp hdust.zip <span class="name variable">$USER</span>&#64;licallo.oca.eu:/beegfs/home/USER

scp -P7025 <span class="name variable">$USER</span>&#64;localhost:/beegfs/home/USER/hdust/runs/hdust/R82/models.tar .
scp -P7025 *.oar <span class="name variable">$USER</span>&#64;localhost:/beegfs/home/USER/hdust/runs/hdust/
scp -P7025 *.oar *.inp <span class="name variable">$USER</span>&#64;localhost:/beegfs/home/USER/hdust/runs/hdust

scp -P7025 <span class="name variable">$USER</span>&#64;localhost:/beegfs/home/USER/hdust/runs/hdust/be_pol_lines/mod01/* .</code></pre>
<p>Exemplos: <a class="reference external" href="https://www.oca.eu/fr/acces-fonctionnement/gestion-des-jobs/1340-exemples-de-scripts">https://www.oca.eu/fr/acces-fonctionnement/gestion-des-jobs/1340-exemples-de-scripts</a></p>
<p>Comandos: <a class="reference external" href="https://www.oca.eu/fr/acces-fonctionnement/gestion-des-jobs/1359-commencer-avec-slurm">https://www.oca.eu/fr/acces-fonctionnement/gestion-des-jobs/1359-commencer-avec-slurm</a></p>
<p>VPN: <a class="reference external" href="https://dsi.oca.eu/spip.php?article912">https://dsi.oca.eu/spip.php?article912</a></p>
<dl class="simple">
<dt>Para compilar o HDUST, Mudar no XDR makefile:</dt>
<dd><ul class="simple">
<li><p>gcc -&gt; icc</p></li>
<li><p>gfortran -&gt; ifort</p></li>
</ul>
</dd>
</dl>
<p>Comandos:</p>
<pre class="code bash literal-block"><code>chmod +x mod01.slurm
sbatch ./mod01c.slurm
squeue <span class="punctuation">|</span> grep acar
scancel numero_do_job</code></pre>
<section id="old-2017-and-before">
<h4><a class="toc-backref" href="#toc-entry-7" role="doc-backlink">Old (2017 and before)</a></h4>
<p>Or Licallo at CRIMSON. Info at <a class="reference external" href="https://crimson.oca.eu/spip.php?rubrique57">https://crimson.oca.eu/spip.php?rubrique57</a></p>
<pre class="code bash literal-block"><code><span class="comment hashbang">#!/bin/bash
</span><span class="comment single">#OAR -n hdust_dmf
#OAR -l /core=24,walltime=12:00:00
#OAR -p gpu='NO'
#OAR -O out.%jobid%
#OAR -E err.%jobid%
</span>
<span class="name builtin">source</span> /softs/env_default.sh
mpiexec.hydra  -machinefile <span class="name variable">$OAR_FILE_NODES</span> <span class="literal string escape">\
</span>-bootstrap ssh -bootstrap-exec /usr/bin/oarsh <span class="literal string escape">\
</span>-envall ./hdustparv2.02.bc <span class="name variable">input</span> <span class="operator">=</span> hdust_bestar2.02.inp</code></pre>
<p>The submission is</p>
<pre class="code bash literal-block"><code>chmod a+x job.oar
oarsub -S ./job.oar

oarstat</code></pre>
<section id="running-times">
<h5><a class="toc-backref" href="#toc-entry-8" role="doc-backlink">Running times</a></h5>
<ul class="simple">
<li><p>bestar2.02, step1, 500000/24, one .temp in 30 sec.</p></li>
<li><p>bestar2.02, SED, ?</p></li>
</ul>
</section>
</section>
</section>
<section id="precalcs">
<h3><a class="toc-backref" href="#toc-entry-9" role="doc-backlink"><span class="docutils literal">precalcs</span></a></h3>
<p>Run it:</p>
<pre class="code bash literal-block"><code>./precalcs &lt; dust.pre &gt; dust.bin</code></pre>
</section>
</section>
<section id="tlusty-synspec">
<h2><a class="toc-backref" href="#toc-entry-10" role="doc-backlink">Tlusty + Synspec</a></h2>
<p>Tlusty: A computer program for calculating non-LTE stellar atmosphere models. The hybrid CL/ALI method + superlevels and supertransitions are treated by Opacity Distribution Functions (ODF).</p>
<p>To compile:</p>
<pre class="code bash literal-block"><code>gfortran -fno-automatic -O3 -ffixed-line-length-none -std<span class="operator">=</span>legacy -o tlusty200 tlusty200.f</code></pre>
<p>Error in line 1365 (<em>Tlusty200</em>):</p>
<pre class="code literal-block"><code>-* ’QTLAS ’,’ITLUCY’,’IACLT ’,’IACLDT</code></pre>
<p>Synspec: a general spectrum synthesis program. It assumes an existing atmospheric model (Tlusty or Kurucz).</p>
<p>Synplot: a wrapper for Synspec.</p>
<section id="kurucz">
<h3><a class="toc-backref" href="#toc-entry-11" role="doc-backlink">Kurucz</a></h3>
<p><a class="reference external" href="http://kurucz.harvard.edu/">http://kurucz.harvard.edu/</a></p>
<p>Hdust uses <span class="docutils literal">ap00k1.pck</span>, with Solar abundances from Anders &amp; Grevesse (1989). In this format, all models are inside a single file.</p>
</section>
<section id="hdust-pro">
<h3><a class="toc-backref" href="#toc-entry-12" role="doc-backlink">hdust.pro</a></h3>
<p>ilow = 2; transitions starting at Balmer series (n = ilow = 2).</p>
<p>Nlower = 6; it will consider the following Nlower series (ilow_max = 2+6-1 = 7).</p>
<p>Nupper = 12; each series above (Nlower) will have Nupper transitions.</p>
<p>Nlines = NupperNlower; this is the total number of transitions considered.</p>
</section>
<section id="synspec-synplot">
<h3><a class="toc-backref" href="#toc-entry-13" role="doc-backlink">Synspec + Synplot</a></h3>
<p>Arquivos necessários para rodar o synspec:</p>
<ul class="simple">
<li><p>synspec (EXE) + rotin (EXE)</p></li>
<li><p>synplot.pro (IDL)</p></li>
<li><p>entrada.5 (&quot;main input&quot;). Aqui também o <span class="docutils literal">.dat</span>, arquivos com as informações das transições das linhas (atom models, no site do Tlusty).</p></li>
<li><p>kurucz.dat. Modelos de atm. do Kurucz - ou do Tlusty.</p></li>
</ul>
<pre class="code literal-block"><code>IDL &gt; synplot49, 0, 0, 0, wsta=6530, we=6600, vrot=0, atmos=['atmos.5', $
'ap00k1tef15000g3.0.dat'], wd=0.5, imode=2, /kurucz, x, y

IDL &gt; synplot49, 0, 0, 0, wsta=6530, we=6600, vrot=0, atmos=[$
'BG15000g300v2'], wd=0.5, imode=2, x, y  ;+ nst file</code></pre>
<p>fort.5 = std input; fort.8 = model.</p>
<p>&quot;Bug&quot; no synspec: se o modelo de atmosfera for de 72 (Kurucz), com <span class="docutils literal">dens=0</span> ele trava (acontece no último nível de atm. Deve-se remover).</p>
<section id="synspec">
<h4><a class="toc-backref" href="#toc-entry-14" role="doc-backlink">Synspec</a></h4>
<p>Para compilar com o synspec com gfortran, vc precisar deixar a linha 1558 e seguinte assim:</p>
<pre class="code literal-block"><code> IF(FINSTD.NE.BLNK)
*   OPEN(UNIT=INPFI,FILE=FINSTD,STATUS='UNKNOWN')</code></pre>
<p>(acho que é só trocar NAME por FILE).</p>
<pre class="code bash literal-block"><code>$ gfortran -g -fno-automatic -static -o synspec49.exe synspec49.f</code></pre>
</section>
</section>
</section>
<section id="vartools">
<h2><a class="toc-backref" href="#toc-entry-15" role="doc-backlink">VARTOOLS</a></h2>
<p><a class="reference external" href="http://www.astro.princeton.edu/~jhartman/vartools.html">http://www.astro.princeton.edu/~jhartman/vartools.html</a></p>
<section id="basic-help-commands">
<h3><a class="toc-backref" href="#toc-entry-16" role="doc-backlink">Basic/help commands</a></h3>
<pre class="code bash literal-block"><code>vartools -listcommands
vartools -help
vartools -help <span class="name variable">$commnad</span>
vartools -example <span class="name variable">$command</span></code></pre>
<section id="basic-rms">
<h4><a class="toc-backref" href="#toc-entry-17" role="doc-backlink">Basic RMS</a></h4>
<p><a href="#system-message-1"><span class="problematic" id="problematic-1">:bash:`vartools -i EXAMPLES/1 -rms`</span></a></p>
<aside class="system-message" id="system-message-1">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">codes_usage.rst</span>, line 245); <em><a href="#problematic-1">backlink</a></em></p>
<p>Unknown interpreted text role &quot;bash&quot;.</p>
</aside>
<p><span class="docutils literal"><span class="pre">-i</span> $file</span>, input of single file</p>
<p><span class="docutils literal"><span class="pre">-rms</span></span>, calculate the RMS of the lightcurve.</p>
</section>
<section id="basic-list-rms">
<h4><a class="toc-backref" href="#toc-entry-18" role="doc-backlink">Basic list RMS</a></h4>
<p><a href="#system-message-2"><span class="problematic" id="problematic-2">:bash:`vartools -l EXAMPLES/lc_list -rms`</span></a></p>
<aside class="system-message" id="system-message-2">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">codes_usage.rst</span>, line 253); <em><a href="#problematic-2">backlink</a></em></p>
<p>Unknown interpreted text role &quot;bash&quot;.</p>
</aside>
<p><span class="docutils literal"><span class="pre">-l</span> $file</span>, where <span class="docutils literal">$file</span> is a filename list containing the light curves, a (sub)file per line. The subfile contains a single lightcurve, 3 col: [JD, mag, errmag].</p>
</section>
</section>
<section id="site-examples">
<h3><a class="toc-backref" href="#toc-entry-19" role="doc-backlink">Site examples</a></h3>
<section id="fitting-a-quadratic-polynomial-in-jd-to-a-list-of-light-curves">
<h4><a class="toc-backref" href="#toc-entry-20" role="doc-backlink">Fitting a quadratic polynomial in JD to a list of light curves</a></h4>
<p><a href="#system-message-3"><span class="problematic" id="problematic-3">:bash:`vartools -l EXAMPLES/lc_list -rms -decorr 1 1 1 0 1 1 2 0 -rms -chi2 -tab`</span></a></p>
<aside class="system-message" id="system-message-3">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">codes_usage.rst</span>, line 261); <em><a href="#problematic-3">backlink</a></em></p>
<p>Unknown interpreted text role &quot;bash&quot;.</p>
</aside>
<dl class="simple">
<dt><span class="docutils literal"><span class="pre">-decorr</span> B B B # # B</span>, decorrelates the light curve against specified signals</dt>
<dd><ul class="simple">
<li><p>0/1 enable/disable</p></li>
<li><p>0/1 zero point term is included</p></li>
<li><p>0/1 subtract the first term</p></li>
<li><p>0/Nglobalterms globalfileN orderN, number of global files (files with JD and signal) + syntax</p></li>
<li><p>Nlcterms lccolumnN lcorderN, is the number of light curve specific signals. The columns of these signals are given by lccolumn1...lccolumnN. The orders of the polynomials are given by lcorder1...lcorderN.</p></li>
<li><p>0/1 output mode, 0 our [dir]. If 1, the output contains the decorrelated signal.</p></li>
</ul>
</dd>
</dl>
<p><span class="docutils literal"><span class="pre">-chi2</span></span>, Calculate chi2 per dof (degree of freedom) for the light curves. The output will include chi2 and the error weighted mean magnitude.</p>
<p><span class="docutils literal"><span class="pre">-tab</span></span> format do output</p>
<p>Minha interpretação: 112 do final do comeando indica que só há um ajust por arquivo (1), as colunas destes sinais são as primeiras, do JD (1), e o polinômio a ser ajustado é de ordem 2 (2). Não faço ideia do pq nao se especifica os dois primeiros termos com <span class="docutils literal"><span class="pre">-i</span></span>.</p>
</section>
<section id="performing-a-lomb-scargle-period-search-on-a-light-curve-and-fitting-a-harmonic-series-to-the-light-curve">
<h4><a class="toc-backref" href="#toc-entry-21" role="doc-backlink">Performing a Lomb-Scargle period search on a light curve and fitting a harmonic series to the light curve</a></h4>
<p><a href="#system-message-4"><span class="problematic" id="problematic-4">:bash:`vartools -i EXAMPLES/2 -LS 1.0 2.0 0.01 1 0 -Killharm ls 0 0 1 EXAMPLES/OUTDIR1 -oneline`</span></a></p>
<aside class="system-message" id="system-message-4">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">codes_usage.rst</span>, line 279); <em><a href="#problematic-4">backlink</a></em></p>
<p>Unknown interpreted text role &quot;bash&quot;.</p>
</aside>
<dl class="simple">
<dt><span class="docutils literal"><span class="pre">-LS</span></span>, Perform a Generalized Lomb-Scargle (L-S) search of the light curves for periodic sinusoidal signals. The search is done over frequencies between fmin = 1/maxp to fmax = 1/minp, with a uniform frequency step-size of Delta f = subsample/T, where T is the time-span of the observations.</dt>
<dd><ul class="simple">
<li><p>minp maxp subsample Npeaks o(uput)periodogram</p></li>
</ul>
</dd>
<dt><span class="docutils literal"><span class="pre">-Killharm</span></span>, This command whitens light curves against one or more periods. The mean value of the light curve, the period of the light curve and the cos and sin coefficients are output.</dt>
<dd><p>Killharm_Per1_Amplitude_1 = Max-Min</p>
</dd>
</dl>
<p><span class="docutils literal"><span class="pre">-oneline</span></span>, Output each statistic on a separate line rather than using the default of outputing a table. This option can provide more readable output when processing a single light curve. It is not suggested when processing a list of light curves.</p>
</section>
</section>
</section>
<section id="amdlib">
<h2><a class="toc-backref" href="#toc-entry-22" role="doc-backlink">amdlib</a></h2>
<p><a class="reference external" href="http://www.jmmc.fr/data_processing_amber.htm">http://www.jmmc.fr/data_processing_amber.htm</a></p>
<section id="install">
<h3><a class="toc-backref" href="#toc-entry-23" role="doc-backlink">Install</a></h3>
<p>It worked on Ubuntu 13.10 32-bits (v3.0.6+) and 14.04 64-bits (v3.0.9). Problems with Ubuntu 14.04  and (v3.0.[6-8]) (32-bits and 64-bits).</p>
<pre class="code bash literal-block"><code>sudo apt-get install yorick</code></pre>
<p>Simply unzip the corresponding bin zip and add /path/amdlib-VERSION/bin/amdlib to your <cite>~/.bashrc</cite>:</p>
<pre class="code bash literal-block"><code><span class="name builtin">alias</span> <span class="name variable">amdlib</span><span class="operator">=</span><span class="literal string double">&quot;</span><span class="name variable">$HOME</span><span class="literal string double">/amdlib/bin/amdlib&quot;</span></code></pre>
</section>
<section id="running">
<h3><a class="toc-backref" href="#toc-entry-24" role="doc-backlink">Running</a></h3>
<pre class="code literal-block"><code>// Access help
help,amdlibFunction
// To run a script
include,&quot;/path/to/script.i&quot;;</code></pre>
</section>
</section>
<section id="compiling-tips">
<h2><a class="toc-backref" href="#toc-entry-25" role="doc-backlink">compiling tips</a></h2>
<section id="general-1">
<h3><a class="toc-backref" href="#toc-entry-26" role="doc-backlink">General</a></h3>
<section id="ld-cannot-find-lm">
<h4><a class="toc-backref" href="#toc-entry-27" role="doc-backlink"><span class="docutils literal">ld: cannot find <span class="pre">-lm</span></span></a></h4>
<p>It means that an required static library was not found. You can:
- (Install the library)
- Specify library location using <span class="docutils literal"><span class="pre">-L</span></span> flag (<span class="docutils literal"><span class="pre">-L/usr/lib/x86_x64/</span></span>)
- Or add the location of libraries to <span class="docutils literal">LIBRARY_PATH</span> variable
- Or don't use the <span class="docutils literal"><span class="pre">-static</span></span> or <span class="docutils literal"><span class="pre">-fast</span></span> compiler options.</p>
</section>
<section id="what-libraries-are-being-used-during-compile">
<h4><a class="toc-backref" href="#toc-entry-28" role="doc-backlink">What libraries are being used during compile?</a></h4>
<p>Do <span class="docutils literal">make VERBOSE=1 or gcc <span class="pre">-v</span></span> and double check where it's picking up libraries from</p>
</section>
</section>
<section id="cmake">
<h3><a class="toc-backref" href="#toc-entry-29" role="doc-backlink"><span class="docutils literal">cmake</span></a></h3>
<section id="customize-cmake-options">
<h4><a class="toc-backref" href="#toc-entry-30" role="doc-backlink">Customize <span class="docutils literal">cmake</span> options</a></h4>
<ul class="simple">
<li><p><span class="docutils literal"><span class="pre">-DCMAKE_INSTALL_PREFIX=/some/other/path</span></span></p></li>
<li><p><span class="docutils literal"><span class="pre">-DCMAKE_C_COMPILER=/opt/local/compilers/gcc-7/bin/gcc</span></span></p></li>
</ul>
</section>
<section id="is-there-an-uninstall-for-cmake-install">
<h4><a class="toc-backref" href="#toc-entry-31" role="doc-backlink">Is there an &quot;uninstall&quot; for cmake install?</a></h4>
<p>Typically it's on the library author to support that. <span class="docutils literal">cmake</span> doesn't intrinsically support uninstalling. There is this, though: <a class="reference external" href="https://gitlab.kitware.com/cmake/community/-/wikis/FAQ#can-i-do-make-uninstall-with-cmake">https://gitlab.kitware.com/cmake/community/-/wikis/FAQ#can-i-do-make-uninstall-with-cmake</a>
<span class="docutils literal">xargs rm &lt; install_manifest.txt</span></p>
</section>
</section>
</section>
<section id="usp-rice">
<h2><a class="toc-backref" href="#toc-entry-32" role="doc-backlink">USP-Rice</a></h2>
<section id="antigo-usando-os-recursos-rice">
<h3><a class="toc-backref" href="#toc-entry-33" role="doc-backlink">Antigo (Usando os recursos Rice)</a></h3>
<section id="usando-o-bg-p">
<h4><a class="toc-backref" href="#toc-entry-34" role="doc-backlink">Usando o BG/P</a></h4>
<p>E-mail + conversa no <a class="reference external" href="mailto:lcca&#64;usp.br">lcca&#64;usp.br</a>. Então, aprovação do Paul (ele me mandou um e-mail).</p>
<p>Acesso a máquina <strong>bluegene.rice.edu</strong> (aliased to bgp-fn.rcsg.rice.edu). If you are not on the Rice network, this is accomplished by tunneling a connection through shark.lcca.usp.br or gw.rcsg.rice.edu.</p>
<p>If you do not have an account on shark, contact LCCA.</p>
<p>gw.rcsg.rice.edu will use your Rice NetID account information.</p>
<p><em>When using secure shell to transfer files, it helps to employ a simpler encryption algorithm, use '-c arcfour' to speed up transfers.</em></p>
<p>E-mail para o <a class="reference external" href="mailto:lcca&#64;usp.br">lcca&#64;usp.br</a> em 17/04/15:</p>
<pre class="literal-block">Eu já recebi a aprovação do Paul. Quais são os próximos passos???

- O username (Rice NetID) será automaticamente gerado??

    Foi. Userr dm#

- Minha conta será para o BG/P, Q ou ambos? Pelo que eu entendi, o endereço bluegene.rice.edu apontará para o Q.
Como acessar o P?

    Só o P.

- No site rice.usp.br, quando eu clico em &quot;Getting Started on BG/P&quot; ele automaticamente vai para a página do &quot;Q&quot;...
Os procedimentos são os mesmos em ambos?

- O número mínimo de cores a serem solicitados no Q são 512? Como (e onde) fazer os testes com meu código?
Os testes deveriam ser feitos com menos cores...

A referência do código desenvolvido pelo meu orientador é http://adslabs.org/adsabs/abs/2006ApJ...639.1081C/</pre>
</section>
<section id="compilando">
<h4><a class="toc-backref" href="#toc-entry-35" role="doc-backlink">Compilando</a></h4>
<p>mpi/gcc - erro no mpif90. Serial ok.</p>
<p>mpi/fast (XL IBM compiler). mpif90/mpif77; Não usar xlf90/xlf ou xlc,
usar <strong>bgxlf_r</strong> e <strong>bgxlc_r</strong>;</p>
<pre class="code literal-block"><code>...
(.text+0x1f258): undefined reference to `fxdrrl'
inicializa.o: In function `create_averaged_temp_file':
(.text+0x1f9d0): undefined reference to `fxdrrl'
inicializa.o: In function `create_averaged_temp_file':
(.text+0x1f9ec): undefined reference to `fxdrrl'
inicializa.o:(.text+0x1fa04): more undefined references to `fxdrrl' follow
inicializa.o: In function `create_averaged_temp_file':
(.text+0x1fb8c): undefined reference to `fxdrcls'
inicializa.o: In function `create_averaged_temp_file':
(.text+0x20050): undefined reference to `fxdrini'
inicializa.o: In function `create_averaged_temp_file':
...
make: *** [../../runs/hdust/hdustparv2.02.bc] Error 1</code></pre>
<p>Help: <a class="reference external" href="https://docs.rice.edu/confluence/display/ITDIY/Request+Help+with+Research+Computing+Resources">https://docs.rice.edu/confluence/display/ITDIY/Request+Help+with+Research+Computing+Resources</a></p>
<p>The above link and HelpDesk are the same!!</p>
</section>
<section id="queues-running">
<h4><a class="toc-backref" href="#toc-entry-36" role="doc-backlink">Queues + Running</a></h4>
<p><a class="reference external" href="https://docs.rice.edu/confluence/display/ITDIY/IBM+Blue+Gene+Documentation">https://docs.rice.edu/confluence/display/ITDIY/IBM+Blue+Gene+Documentation</a></p>
<pre class="code literal-block"><code>#&#64; job_name = hello_dm#
#&#64; comment = &quot;Hdust test&quot;
#&#64; error = $(job_name).$(jobid).err
#&#64; output = $(job_name).$(jobid).out
#&#64; environment = COPY_ALL
#&#64; wall_clock_limit = 00:30:00
#&#64; notification = error
#&#64; job_type = bluegene
#&#64; class = devel
#&#64; group = pcw2
#&#64; bg_size = 128
#&#64; queue

/bgsys/drivers/ppcfloor/bin/mpirun -exe /bgpscratch/dm#/hdust/hdustparv2.02.bc \
-mode VN -np 512 -args &quot; = hdust_bestar2.02.inp&quot;</code></pre>
<p>The queue managener commands <span class="docutils literal">llsubmit ./sample.bgq</span>, <span class="docutils literal">llq</span> and <span class="docutils literal">llcancel <span class="pre">bgp-fn.xxx</span></span>.</p>
</section>
<section id="tests">
<h4><a class="toc-backref" href="#toc-entry-37" role="doc-backlink">Tests</a></h4>
<p><em>bestar2.02/mod01/mod01b.txt</em>; step1 = 500,000 photons; 33 *.temp files in 20 minutes.</p>
<p><em>bestar2.02/mod01/mod01b.txt</em>; step1 = 2,000,000 photons; 33 *.temp files in 35 minutes.</p>
<p>Figure below: blue, distribution; green, BG/P.</p>
<img alt="../figs/usp-rice_tests.png" src="../figs/usp-rice_tests.png" style="width: 600px;" />
<img alt="../figs/usp-rice_tests2.png" src="../figs/usp-rice_tests2.png" style="width: 600px;" />
</section>
</section>
<section id="usando-os-recursos-rice-ii-set-2015-jan-2016">
<h3><a class="toc-backref" href="#toc-entry-38" role="doc-backlink">Usando os recursos Rice II - Set/2015-Jan/2016</a></h3>
<section id="inscricao">
<h4><a class="toc-backref" href="#toc-entry-39" role="doc-backlink">Inscrição</a></h4>
<p>Os passos são:</p>
<ol class="arabic simple">
<li><p>E-mail para o LCCA pedindo uma conta (com info. do HDUST e mini-projeto)</p></li>
<li><p>(LCCA vai confirmar as infos. com o Alex, que responderá com um ok)</p></li>
<li><p>(O LCCA vai encaminhar um e-mail ao Paul, na Rice)</p></li>
<li><p>Preenche-se um formulário solicitando um Rice NetID (coloca-se senha, mas sem <em>username</em>). Informar o Paul como <em>sponsor</em>.</p></li>
<li><p>Receber o Rice NetID (<em>username</em>)</p></li>
<li><p>Preencher um segundo formulário pedindo acesso ao BG/Q</p></li>
<li><p>(O Paul vai liberar o acesso) e pronto! (UFA)</p></li>
</ol>
<ul class="simple">
<li><p>Send the following information from your USP email address to <a class="reference external" href="mailto:lcca&#64;usp.br">lcca&#64;usp.br</a>: Your name, position (i.e. grad student, post-doc, professor), department, the name of the PI (make sure to cc the PI when making the request, since they will need to confirm the request), software you want to use on the BG, estimated number of cores per calculation, and a 1-2 paragraph description of the types of calculations you want to perform.</p></li>
</ul>
<div class="line-block">
<div class="line">Name: Daniel Moser Faes</div>
<div class="line">Position: PhD Student</div>
<div class="line">PI: Professor Alex Cavalieri Carciofi</div>
<div class="line">Institution: IAG-USP</div>
<div class="line">Code: User developed gfortran code with MPI</div>
<div class="line">Description of research problem: 3D Non-LTE Monte Carlo simulations of radiative transfer in astrophysics environments (HDUST Code). Our code is capable of simulate winds, disks and dust in interaction with a given radiation field. Our goal is to study the circumstellar disks around Be stars.</div>
<div class="line">Required software: Fortran and C compilers; MPI</div>
<div class="line">Requested number of core hours and the number cores per job: Initially, we will study around a hundred of models. Each model will require approximately one hour of computation in 256 core of 3GHz.</div>
</div>
<ul class="simple">
<li><p>After you receive confirmation from LCCA, request a Rice Guest Account here (<a class="reference external" href="https://my.rice.edu/GuestAccount/form.jsp">https://my.rice.edu/GuestAccount/form.jsp</a>). When requesting the Rice Account, indicate <a class="reference external" href="mailto:pcw2&#64;rice.edu">pcw2&#64;rice.edu</a> as your sponsor (DO NOT select &quot;BlueGene USP Allocation&quot; as the sponsor), and forward the LCCA approval email to that address. It is VERY important that you provide a valid email address when you request an account. If we can not contact you, then your accounts may be terminated without notice. Finally, if you do not obtain approval from LCCA first, the Rice Guest Account will not be approved.</p></li>
</ul>
<p>When your guest account is approved, you will be assigned a Rice NetID.  This will be your login information for all resources located at Rice, so don't lose it. Typically, the Rice ID will be activated within 24 hours. Once the Rice ID is active, we will activate your account on the BG/P. You will also be added to the USP BGP listserve. If you don't receive confirmation within 3 business days about the listserve, or BG/P account, please inquire with the sponsor (Paul Whitford, <a class="reference external" href="mailto:pcw2&#64;rice.edu">pcw2&#64;rice.edu</a>).</p>
<p>Once your account is activated on the BG, you will need to connect via secure shell (bluegene.rice.edu). If you are not on the Rice network, this is accomplished by tunneling a connection through shark.lcca.usp.br or gw.rcsg.rice.edu. If you do not have an account on shark, contact LCCA. gw.rcsg.rice.edu will use your Rice NetID account information.</p>
<p>Dúvidas aqui:
<a class="reference external" href="http://usp.rice.edu">http://usp.rice.edu</a></p>
</section>
<section id="primeiros-passos">
<h4><a class="toc-backref" href="#toc-entry-40" role="doc-backlink">Primeiros passos</a></h4>
<p><a class="reference external" href="https://docs.rice.edu/confluence/display/ITDIY/Bluegene+Q+Getting+Started+Guide">https://docs.rice.edu/confluence/display/ITDIY/Bluegene+Q+Getting+Started+Guide</a></p>
<ol class="arabic">
<li><p>$ ssh <a class="reference external" href="mailto:dm#&#64;gw.rcsg.rice.edu">dm#&#64;gw.rcsg.rice.edu</a></p></li>
<li><p>$ ssh bluegene.rice.edu</p></li>
<li><p>Módulos <a class="reference external" href="https://docs.rice.edu/confluence/display/ITDIY/Customizing+Your+Environment+with+the+Module+Command">https://docs.rice.edu/confluence/display/ITDIY/Customizing+Your+Environment+with+the+Module+Command</a></p>
<blockquote>
<div class="line-block">
<div class="line">$ module avail</div>
<div class="line">$ module load mpi</div>
<div class="line">$ module list</div>
<div class="line"># $ module purge</div>
</div>
</blockquote>
</li>
<li><p>mkdir /bgpscratch/<cite>whoami</cite></p></li>
</ol>
<p>Submit ALL jobs from your scratch directory, and job output should only be written to the scratch directory. Executables may remain in your home directory, but do not write to the home during a job.
Purge Policies</p>
<p>Files in the scratch directory that are more than 2 weeks old will be removed automatically.</p>
<ol class="arabic simple" start="5">
<li><p>Job scheduling is done via Loadleveler.</p></li>
</ol>
<p>Cores are allocated in blocks of 512 CORES [bg_size=128(*4)]. If you request less than this, you will still be allocated 512 CORES, meaning that the additional cores are going to be sitting idle. Whenever your number of cores is not an integer multiple of 512, there will be idle cores. Please ensure that you do not waste cycles unintentionally.</p>
</section>
<section id="exemplo-transferencia-de-arquivos">
<h4><a class="toc-backref" href="#toc-entry-41" role="doc-backlink">Exemplo transferencia de arquivos</a></h4>
<pre class="code bash literal-block"><code>$ scp /data/hdust.zip dm#&#64;gw.rcsg.rice.edu:/tmp
The Rice University Network - Unauthorized access is prohibited
dm#&#64;gw.rcsg.rice.edu<span class="literal string single">'s password:
hdust.zip                         100%   35MB   3.9MB/s   00:09

$ scp gw.rcsg.rice.edu:/tmp/hdust.zip .
Warning: Permanently added '</span>gw.rcsg.rice.edu,128.42.60.30<span class="literal string single">' (RSA) to the list of known hosts.
The Rice University Network - Unauthorized access is prohibited
dm#&#64;gw.rcsg.rice.edu'</span>s password:
hdust.zip                                           <span class="literal number">100</span>%   35MB  <span class="literal number">35</span>.2MB/s   <span class="literal number">00</span>:00</code></pre>
</section>
<section id="compilando-e-ajustando">
<h4><a class="toc-backref" href="#toc-entry-42" role="doc-backlink">Compilando e ajustando</a></h4>
<pre class="code bash literal-block"><code>$ vim xdr/v1.06/Makefile</code></pre>
<pre class="literal-block">CC = bgxlc_r
COPTS =  -c -O -DAIX
F77 = bgxlf_r
FOPTS = -c -O</pre>
<pre class="code bash literal-block"><code>$ vim fortran/hdustv2.02/Makefile</code></pre>
<pre class="literal-block">CFLAGS = -O2
FC = bgxlf95_r
FC2 = bgxlf_r
...
.f.o:
    $(FC2) $(CFLAGS) -c $*.f</pre>
<pre class="code bash literal-block"><code>$ module load mpi
<span class="comment single"># In the *special* hdustparv2.02 directory, i.e., replace the files with the following ones:
</span>$ wget http://dl.dropbox.com/u/6569986/transfer/hdustparv2.02bgp.zip
<span class="comment single">#
</span>$ vim fortran/hdustparv2.02bgq/Makefile</code></pre>
<pre class="literal-block">CFLAGS = -O2
FC = mpixlf95_r
FC2 = mpixlf77_r
...
.f.o:
    $(FC2) $(CFLAGS) -c $*.f</pre>
<p>E também tem que mudar a pasta temporária dos <cite>controls</cite>:</p>
<pre class="code bash literal-block"><code>$ <span class="name builtin">cd</span> /bgqscratch/<span class="literal string backtick">`</span>whoami<span class="literal string backtick">`</span>/hdust/runs/hdust
$ mkdir ../tmp
$ vim bestar2.02/controls/controls.txt
<span class="comment single"># line 63:  Path = '../tmp/'</span></code></pre>
</section>
<section id="queues-running-1">
<h4><a class="toc-backref" href="#toc-entry-43" role="doc-backlink">Queues + Running</a></h4>
<p><a class="reference external" href="https://docs.rice.edu/confluence/pages/viewpage.action?pageId=49974118">https://docs.rice.edu/confluence/pages/viewpage.action?pageId=49974118</a></p>
<p>Create the file <cite>job.cmd</cite>:</p>
<pre class="literal-block">#&#64; job_name = hdust
#&#64; comment = &quot;HDUST run&quot;
#&#64; error = $(job_name).$(bg_size).err
#&#64; output = $(job_name).$(bg_size).out
#&#64; environment = COPY_ALL
#&#64; wall_clock_limit = 24:00:00
#&#64; notification = error
#&#64; job_type = bluegene
#&#64; class = usp
#&#64; group = usp
#&#64; bg_size = 32
#&#64; queue

EXE=&quot;/home/dmf#/hdust/runs/hdust/hdustparv2.02.bc&quot;
ARGS=&quot; = beauty/mod01/all.inp&quot;

runjob --np 512 --ranks-per-node=16 --exe $EXE --args $ARGS</pre>
<pre class="code bash literal-block"><code><span class="comment single"># Submit job
</span>$ llsubmit job.cmd
<span class="comment single"># see the queue
</span>$ llq
<span class="comment single"># cancel jobs
</span>$ llcancel jobID</code></pre>
</section>
<section id="testes">
<h4><a class="toc-backref" href="#toc-entry-44" role="doc-backlink">Testes</a></h4>
<p><strong>BgQ</strong> 512 cores:
- step1, 10000000, 3.2 min = ~6500 f/min/core
- step1_refine, 30000000, 8.5 min = ~6500 f/min/core
- SED (Sob=0), 22500000, 6 min = ~7300 f/min/core</p>
<p><strong>Acrux</strong> 48 cores:
- step1, 2500000, 4 min = ~13000 f/min/core
- step1_refine, 12000000, 19 min = ~13000 f/min/core
- SED (Sob=0), 1350000000, 370 min = ~76013 f/min/core</p>
</section>
<section id="additional-user-support-on-the-bg">
<h4><a class="toc-backref" href="#toc-entry-45" role="doc-backlink">Additional User Support on the BG</a></h4>
<blockquote>
<p>There are many people available to help you if you encounter troubles when using the BG. For USP users, you can always email questions to LCCA. All users can also contact Paul Whitford (<a class="reference external" href="mailto:pcw2&#64;rice.edu">pcw2&#64;rice.edu</a>) for any questions that you may have. For assistance running specific applications, you can contact our technical staff member, Xiaoqin Huang at <a class="reference external" href="mailto:xh14&#64;rice.edu">xh14&#64;rice.edu</a>.</p>
<p>If you are running on BG, and you find that your jobs simply stop working, then there may be an issue with the BG/P itself.  In that case, it is recommended that you file a ticket with the RCSG staff, using the RCSG help request page (<a class="reference external" href="https://docs.rice.edu/confluence/display/ITDIY/Request+Help+with+Research+Computing+Resources">https://docs.rice.edu/confluence/display/ITDIY/Request+Help+with+Research+Computing+Resources</a>).  When filing a ticket, the more information you provide, the more helpful they can be.  For example, send the full error message issued when the job crashed, what directory the job was sent from, what the job number was, etc.</p>
</blockquote>
</section>
<section id="extra">
<h4><a class="toc-backref" href="#toc-entry-46" role="doc-backlink">Extra</a></h4>
<pre class="literal-block">Dear,
After a code upgrade, we are trying to run our MPI fortran code (HDUST) again at BlueGene. We had some issues in the code last May (2015) still at BGP and Mr. Qiyou Jiang helped us at that time.

The code different sources are:
- Serial: /home/dmf7/hdust/fortran/hdustv2.02/
- Parallel (v2.02 corrected version of Mr. Jiang): /home/dmf7/hdust/fortran/hdustparv2.02bgp/
- Parallel (new version): /home/dmf7/hdust/fortran/hdustparv2.021/

The GNU executables ends with .gc and XL with .bc (/bgqscratch/dmf7/hdust/)

First issue: when I compile the serial code with GNU compilers, it works nicely. When I compile it with XL, I get
&quot;Ilegal instruction (core image recorded)&quot;
GNU: ./hdustv2.02.gc input = hdust_bestar2.02.inp
XL: ./hdustv2.02.bc input = hdust_bestar2.02.inp
Probably the source of the error is at the SUBROUTINE setup_rigid_star() [line 3672, input_v2.f90]

comment: the codes makes use of a library called XDR. When compiling the parallel version of HDUST with MPI/GCC, the MPI only compiles if the XDR library was compiled with XL compilers (!?).
On the other hand, the GNU HDUST serial version only works if XDR was compiled with GNU compilers.

Second: The new version (v2.021) is working on x86-based machines, but here it appears that there is an MPI communication error. For example, the status of each slave returning to the master is indicated by the number of photons in the output. It should never be zero, but this is what we are receiving (hdust*.out files).

Could you help us again debugging the new version?
Regards,
Daniel</pre>
</section>
<section id="outros-recursos">
<h4><a class="toc-backref" href="#toc-entry-47" role="doc-backlink">Outros recursos</a></h4>
<p>Acessos além do BG/P-Q devem ser negociados... DaVinci, STIC, etc...</p>
</section>
</section>
</section>
</main>
</body>
</html>
