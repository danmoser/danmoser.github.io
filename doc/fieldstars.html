<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>fieldstars: module of field stars tools &mdash; Python tools for the BeACoN group Beta documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'Beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Python tools for the BeACoN group Beta documentation" href="index.html" />
    <link rel="next" title="hdrpil: auxiliary module to apply HDR to images" href="hdrpil.html" />
    <link rel="prev" title="beatlas: module of BeAtlas tools" href="beatlas.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hdrpil.html" title="hdrpil: auxiliary module to apply HDR to images"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="beatlas.html" title="beatlas: module of BeAtlas tools"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Python tools for the BeACoN group Beta documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-pyhdust.fieldstars">
<span id="fieldstars-module-of-field-stars-tools"></span><h1><strong>fieldstars</strong>: module of field stars tools<a class="headerlink" href="#module-pyhdust.fieldstars" title="Permalink to this headline">¶</a></h1>
<p>Tools for field stars</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">author:</th><td class="field-body"><ol class="first upperalpha simple" start="4">
<li>Bednarski</li>
</ol>
</td>
</tr>
<tr class="field-even field"><th class="field-name">license:</th><td class="field-body"><p class="first last">GNU GPL v3.0 (<a class="reference external" href="https://github.com/danmoser/pyhdust/blob/master/LICENSE">https://github.com/danmoser/pyhdust/blob/master/LICENSE</a>)</p>
</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="pyhdust.fieldstars.binData">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">binData</tt><big>(</big><em>objarr</em>, <em>xarr</em>, <em>yarr</em>, <em>zarr=None</em>, <em>ignx=False</em>, <em>igny=False</em>, <em>prevent=False</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#binData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.binData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin data</p>
<dl class="docutils">
<dt>objarr is a list [[objects], [filters], [flags]]</dt>
<dd>xarr is a list [[x values], [sx values]]  (idem for yarr and zarr)</dd>
</dl>
<p>If zarr is void, bin just the y values and calculate error by
propagation only (no stddev). Otherwise, bin only the z values.</p>
<ul>
<li><dl class="first docutils">
<dt>prevent:   prevent to bin when flags contain &#8216;no-std&#8217;? If True,</dt>
<dd><p class="first last">case there are more than one point able to be binned,
bin only the data which don&#8217;t have &#8216;no-std&#8217; flag. The
output lists will have a copy of every line from those
in input lists with &#8216;no-std&#8217; flag, as like as the
binned lines among those that just don&#8217;t have &#8216;no-std&#8217;
flag.</p>
</dd>
</dl>
</li>
</ul>
<p>CAUTION: only bins when the contents of objarr AND xarr are the
same (AND yarr also, case zarr != None)! Only if ignx or/and igny
parameter have value &#8216;True&#8217; the routine ignores when xarr or/and
yarr have not the same values. In this case, the x or/and y value
to be returned are taken from the first occurrence.</p>
<p>CONSIDERATIONS:</p>
<ul class="simple">
<li>The error of binned data is just the propagated error,
sqrt(sum(sigma_i^2))/n, and doesn&#8217;t consider the stddev</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.fitSerk">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">fitSerk</tt><big>(</big><em>larr</em>, <em>parr</em>, <em>sarr</em>, <em>star=''</em>, <em>law='w82'</em>, <em>n_burnin=300</em>, <em>n_mcmc=800</em>, <em>n_walkers=120</em>, <em>extens='pdf'</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#fitSerk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.fitSerk" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><blockquote>
<div><p>Fit Serkowski law using Markov Chain Monte Carlo
from emcee code.
The likelihood function (L) supposes Gaussian
errors around the Pmax values:</p>
<p>log(L) = -0.5*chi2 -0.5*sum(ln(2*pi*sy^2))</p>
</div></blockquote>
<p>INPUT:</p>
<blockquote>
<div><p>larr: array/list with lambda values
parr: array/list with P values
sarr: array/list with the sigma_P values
star: star name to be printed in the graph and</p>
<blockquote>
<div><blockquote>
<div>its filename. If it&#8217;s a void str &#8216;&#8217;, this
routine give a random number to prevent
overwriting data.</div></blockquote>
<dl class="docutils">
<dt>law: what K value in Serkowski&#8217;s law use?</dt>
<dd>(see polt.serkowski).</dd>
</dl>
</div></blockquote>
</div></blockquote>
<dl class="docutils">
<dt>n_burnin: number of iterations for burning-in</dt>
<dd>n_mcmc: number of iterations to run emcee</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>n_walkers: number of walkers to map the posterior</dt>
<dd><blockquote class="first">
<div><blockquote>
<div>probabilities.</div></blockquote>
<p>extens: extension for the graph file</p>
</div></blockquote>
<p>OUTPUT: sorted like &#8220;pmax_fit, lmax_fit, chi2&#8221;</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>pmax_fit: [Pmax, sPmax_+, <a href="#id1"><span class="problematic" id="id2">sPmax_</span></a>-], the Pmax value and</dt>
<dd>its errors (at right and left from it). Pmax
is the median of distribution probability and
sPmax_+, <a href="#id3"><span class="problematic" id="id4">sPmax_</span></a>- are the range within which
there are 68.3% of the points in such
distribution.</dd>
<dt>lmax_fit: Idem, for lmax.</dt>
<dd>chi2: Reduced chi2.</dd>
</dl>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.fixName">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">fixName</tt><big>(</big><em>star</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#fixName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.fixName" title="Permalink to this definition">¶</a></dt>
<dd><p>Fix the name of star &#8216;star&#8217;, returning the
printable name.</p>
<p>&#8216;hd&#8217;      -&gt;  &#8216;HD &#8216;
&#8216;2MASS-&#8216;  -&gt;  &#8216;&#8217;
&#8216;hip&#8217;     -&gt;  &#8216;HIP &#8216;
&#8216;TYC-&#8216;    -&gt;  &#8216;TYC &#8216;</p>
<p>Return identical &#8216;star&#8217; name if the name was not
identified</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.genInt">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">genInt</tt><big>(</big><em>be, path=None, vfilter=['no-std'], extens='pdf'</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#genInt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.genInt" title="Permalink to this definition">¶</a></dt>
<dd><p>Call polt.graf_qu() for Be star &#8216;be&#8217; and save the intrinsic
angles inside thet_int.csv.</p>
<dl class="docutils">
<dt>path: path inside which the logfile &#8216;be&#8217;.log (out from</dt>
<dd>polt.genTarget) is located. The code will try to open
thet_int.csv inside the current directory (.). If it
was not found, it will be created. Otherwise, the
routine will append a new line inside it, asking about
to overwrite an eventual existing line for star &#8216;be&#8217;.</dd>
</dl>
<p>CONSIDERATIONS:</p>
<ul class="simple">
<li>Propagates errors from standard star.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.gen_color">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">gen_color</tt><big>(</big><em>csvfile</em>, <em>be</em>, <em>obj</em>, <em>onlyY=False</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#gen_color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.gen_color" title="Permalink to this definition">¶</a></dt>
<dd><p>Receives a string &#8216;csvfile&#8217; pointing to the csvfile,
a Be star &#8216;be&#8217; and the field star named &#8216;obj&#8217;. 
Returns a smart computed np array for the color
of such field star.</p>
<p>Note that if you run this task with distinct values
for &#8216;onlyY&#8217;, the color returned may be distinct also.</p>
<p>&#8216;be&#8217; parameter is necessary because some field stars
are used for more than one Be star.</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.gencsv">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">gencsv</tt><big>(</big><em>csvin</em>, <em>path=None</em>, <em>skipdth=False</em>, <em>delta=3.5</em>, <em>epssig=2.0</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#gencsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.gencsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a csvfile with every observations for the standard stars
listed in pyhdust/refs/pol_hip.txt.</p>
<p>Compute lambda_eff using color index and an mean airmass X=1.35.
The error is the (lambda_eff(X=1.7)-lambda_eff(X=1.))/2</p>
<dl class="docutils">
<dt>INPUT</dt>
<dd><dl class="first last docutils">
<dt>csvin        The csv file with the informations</dt>
<dd>about the standard stars. The columns are
indentified through idx1[] dictionary.</dd>
<dt>path         The path to the <tt class="docutils literal"><span class="pre">red</span></tt> directory, inside</dt>
<dd>which are the nights with the observations</dd>
<dt>skipdth      print all target values anyway, even when</dt>
<dd>there are no standard star?</dd>
<dt>epssig       sigP/P max for unpolarized target (sigP/P</dt>
<dd>up to epssig doesn&#8217;t need standard star
case skipdth==False)</dd>
<dt>delta        tolerance for the angle between the two beams</dt>
<dd>of calcite.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.getTable">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">getTable</tt><big>(</big><em>data, x, y, z=None, sx=None, sy=None, sz=None, vfilter=['no-std'], bin_data=True, onlyY=False, unbias='wk'</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#getTable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.getTable" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Receive the list <em>data</em> with many collumns and return
the columns concerning to the <em>x</em>, <em>y</em>, <em>z</em> quantities
(and their errors <em>sx</em>, <em>sy</em>, <em>sz</em>). Returns also &#8216;objarr&#8217;,
a list with object names, filters and validation status.</p>
<dl class="docutils">
<dt>IMPORTANT: 1) Propagates error of delta theta factor for</dt>
<dd><blockquote class="first">
<div>&#8216;q&#8217;, &#8216;u&#8217;, &#8216;p&#8217; and &#8216;thet&#8217; labels</div></blockquote>
<ol class="last arabic simple" start="2">
<li>Apply unbias correction for P and theta values
when specified through &#8216;unbias&#8217; variable.</li>
<li>Case some label is &#8216;q&#8217;, &#8216;u&#8217;, &#8216;p&#8217; or &#8216;thet&#8217;,
&#8216;no-std&#8217; is not in vfilter list and
bin_data==True, don&#8217;t bin the data of those
which have &#8216;no-std&#8217; flag to prevent to compute
values WITH NO MEANING. Return various lines
for every unbinnable data and a line for the
others else binned data.</li>
</ol>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>INPUT</dt>
<dd><blockquote class="first">
<div><p>x,y,z,sx,sy,sz    Label (key) of <em>idx2</em> dictionary.
bin_data          Bin the data in the observations for</p>
<blockquote>
<div>the same object+filter+x variable? Note:
Case y and/or z are &#8216;p&#8217; or &#8216;thet&#8217;,
compute the bins <em>over the Stokes
parameters</em> and then return the values
to &#8216;p&#8217; or &#8216;thet&#8217;!</div></blockquote>
<dl class="docutils">
<dt>onlyY             True = only selects the list with</dt>
<dd>a &#8220;Y&#8221; marked</dd>
<dt>unbias            Estimator to unbias the data when &#8216;y&#8217; or &#8216;z&#8217;</dt>
<dd><dl class="first docutils">
<dt>is equals to &#8216;p&#8217; or &#8216;thet&#8217;. Three options:</dt>
<dd><ol class="first last loweralpha simple">
<li>&#8216;ml&#8217;: Maximum Likelihood (K=1.41)</li>
<li>&#8216;wk&#8217;: Wardle &amp; Kronberg (K=1.0)</li>
<li>&#8216;&#8217;  : None (K=0.)</li>
</ol>
</dd>
</dl>
<p class="last">where K is the factor to unbias (read the
description of routines &#8216;unbiasData&#8217; and
&#8216;meanAngle&#8217;.</p>
</dd>
<dt>vfilter           List whose elements are the labels (tags)</dt>
<dd>to be filtered from the output. It can be
&#8216;full&#8217;, &#8216;prob&#8217; or &#8216;comp&#8217; for these
pre-defined lists in polt.vfil dictionary.</dd>
</dl>
<p>To mount your own list vfilter, select the current tags:</p>
</div></blockquote>
<p># General tags for target/standard observation
- &#8216;bad-mod&#8217;         bad modulation
- &#8216;very-bad-mod&#8217;    very bad modulation
- &#8216;incomp-mods&#8217;     some modulations are incompatible
- &#8216;obs-prob&#8217;        some observational problem/error
- &#8216;iagpol-prob&#8217;     polarimeter problem suspected
- &#8216;other-prob&#8217;      another relevant problem
- &#8216;obs!=pub&#8217;        std incompatible with the published</p>
<p class="last"># Tags for standard status
- &#8216;no-std&#8217;          no standard in the night
- &#8216;oth-day-std&#8217;     standard from another day
- &#8216;oth-dth&#8217;         delta theta estimated from another filter</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.graf_field">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">graf_field</tt><big>(</big><em>csvfile, be, vfilter=['no-std'], squared=True, save=False, bin_data=True, onlyY=False, extens='pdf', unbias='wk'</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#graf_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.graf_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a field graph with polarization directions for Be star <em>be</em>
through <em>csvfile</em> data table.</p>
<p>squared: use the same scale in both x and y axes?</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.graf_inst">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">graf_inst</tt><big>(</big><em>logfile, mode=1, vfilter=['no-std'], save=False, extens='pdf'</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#graf_inst"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.graf_inst" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a QU diagram for unpolarized standard stars in the
logfile .log file (the outfile from polt.genTarget, appended by
the name of the object at each line). Propagates error of
standard star.</p>
<p>mode=1 plot BVRI graphs in the same figure;
mode=2 plot UBVRI graphs in separeted figures.</p>
<p>Return 3 lists:</p>
<ol class="arabic simple">
<li>qarr = [[mean Q], [propagated Q error], [Q stddev]]</li>
<li>uarr = [[mean U], [propagated U error], [U stddev]]</li>
<li>narr = [n] (the number of data used to compute the averages)</li>
</ol>
<p>Where [mean Q], [propagated Q error], ..., [n] are lists with
the values for each filter.</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.graf_p">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">graf_p</tt><big>(</big><em>csvfile</em>, <em>be</em>, <em>thetfile=None</em>, <em>path=None</em>, <em>vfilter=</em>, <span class="optional">[</span><span class="optional">]</span><em>save=False</em>, <em>bin_data=True</em>, <em>onlyY=False</em>, <em>every=False</em>, <em>rotate=False</em>, <em>fit=True</em>, <em>unbias='wk'</em>, <em>law='w82'</em>, <em>extens='pdf'</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#graf_p"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.graf_p" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot  P x wavelength for star &#8216;be&#8217; and operate over a
/&#8217;be&#8217;_is.csv file. The field stars are read from &#8216;csvfile&#8217;.</p>
<p>Fix the polarization bias using Wardle &amp; Kronberg formula.</p>
<p>&#8216;csvfile&#8217; : location of dados.csv (field stars data).</p>
<dl class="docutils">
<dt>&#8216;path&#8217; <span class="classifier-delimiter">:</span> <span class="classifier">the path where is located the log file for star &#8216;be&#8217;</span></dt>
<dd>(out from polt.genTarget). If None, it is supposed
inside the current directory (.).</dd>
</dl>
<p>&#8216;bin_data&#8217;: bin data in graphs?</p>
<dl class="docutils">
<dt>&#8216;onlyY&#8217; <span class="classifier-delimiter">:</span> <span class="classifier">use only the field stars with &#8216;Y&#8217; marks (field</span></dt>
<dd>stars originally selected for Be star &#8216;be&#8217;)?</dd>
<dt>&#8216;thetfile&#8217; <span class="classifier-delimiter">:</span> <span class="classifier">file with the intrinsic angles (oufile from</span></dt>
<dd>fs.genInt). If &#8216;thetfile&#8217; != None, plot the
ISP component parallel to the disk of the Be
star. It is done by rotating the data in QU
diagram at the angle corresponding to the disk
inclination.</dd>
<dt>&#8216;unbias&#8217; <span class="classifier-delimiter">:</span> <span class="classifier">Estimator to unbias the data when &#8216;y&#8217; or &#8216;z&#8217;</span></dt>
<dd><dl class="first docutils">
<dt>is equals to &#8216;p&#8217; or &#8216;thet&#8217;. Three options:</dt>
<dd><ol class="first last loweralpha simple">
<li>&#8216;ml&#8217;: Maximum Likelihood (K=1.41)</li>
<li>&#8216;wk&#8217;: Wardle &amp; Kronberg (K=1.0)</li>
<li>&#8216;&#8217;  : None (K=0.)</li>
</ol>
</dd>
</dl>
<p class="last">where K is the factor to unbias (read the
description of routines &#8216;unbiasData&#8217; and
&#8216;meanAngle&#8217;.</p>
</dd>
<dt>&#8216;every&#8217; <span class="classifier-delimiter">:</span> <span class="classifier">use one intrinsic angle for each one filter to</span></dt>
<dd>obtain the // component? If every=False makes
all data to use a mean value at the -4:-2 collums
(22th to 24th) from &#8216;thetfile&#8217;</dd>
<dt>&#8216;fit&#8217;: fit the ISP using MCMC? Case True, generate the</dt>
<dd>graphs and a file ./&#8217;be&#8217;_is.csv with the best values.
Write the mean polarization angles inside this file
also. Case fit==True and there exists this file, this
routine will ask to the user if he wants to read the
previous fitted parameters and plot the Serkowski curves
using them, or if he wants to run MCMC again,
overwriting this file. If there exists a ./&#8217;be&#8217;_is.csv
file and some standard star was not fitted yet, this
routine will do that and append a line to the csv file.</dd>
<dt>&#8216;rotate&#8217; <span class="classifier-delimiter">:</span> <span class="classifier">DON&#8217;T WORKING PROPERLY. Rotate the polarization of</span></dt>
<dd>field stars in QU diagram by the mean angle? A
option to be explored to replace the unbias procedure.</dd>
</dl>
<p>CONSIDERATIONS:</p>
<ul class="simple">
<li>Error for parallel component is the combination between</li>
</ul>
<p>the propagated error and stddev.
- Error of standard stars is propagated to the field stars
- The polarization angles (PA) inside &#8216;be&#8217;_is.csv are binned</p>
<blockquote>
<div>over Stokes parameters ALWAYS. The errors are computed by the
simple propagation.</div></blockquote>
<ul class="simple">
<li>The mean PA for each star is computed using QU parameters
in all filters, even when p/sigma_p&lt;1 (when the individual
PA error is equals to 51.96), because we are actually
operating over QU space!</li>
<li>p/sigma_p inside &#8216;be&#8217;_is.csv is computed by the ratio of
28.65 and the PA error.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.graf_pradial">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">graf_pradial</tt><big>(</big><em>csvfile</em>, <em>be</em>, <em>filt='pmax'</em>, <em>vfilter=</em>, <span class="optional">[</span><span class="optional">]</span><em>isfile=None</em>, <em>fit=False</em>, <em>bin_data=True</em>, <em>onlyY=True</em>, <em>save=False</em>, <em>extens='pdf'</em>, <em>unbias='wk'</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#graf_pradial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.graf_pradial" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a field graph with polarization versus distance.</p>
<dl class="docutils">
<dt>filt <span class="classifier-delimiter">:</span> <span class="classifier">is the filter to plot in y axes - &#8216;pmax&#8217;,&#8217;u&#8217;,&#8217;b&#8217;,</span></dt>
<dd>&#8216;v&#8217;,&#8217;r&#8217;,&#8217;i&#8217;. If &#8216;pmax&#8217; use the Pmax values
from ./&#8217;be&#8217;_is.csv file to plot.</dd>
<dt>isfile <span class="classifier-delimiter">:</span> <span class="classifier">&#8216;be&#8217;_is.csv file location (out from fs.graf_p).</span></dt>
<dd>If None, it is suposed ./&#8217;be&#8217;_is.csv</dd>
<dt>fit <span class="classifier-delimiter">:</span> <span class="classifier">(only for filt==&#8217;pmax&#8217;) fit a line in graph? This</span></dt>
<dd>routine will not use in fitting the points whose
values in 22th column inside isfile have a &#8216;0&#8217;
character (this column defines the points to be
used in the adjust). The points not used will be
marked with a &#8216;x&#8217; in the graph.</dd>
</dl>
<p>csvfile : location of dados.csv.</p>
<p>Considerations:</p>
<ul class="simple">
<li>If filt==&#8217;pmax&#8217;, don&#8217;t plot the data whose values in 21th</li>
</ul>
<p>column inside isfile have a &#8216;0&#8217; character.</p>
<ul class="simple">
<li>If filt==&#8217;pmax&#8217;, don&#8217;t use in fitting the points whose</li>
</ul>
<p>values in 22th column inside isfile have a &#8216;0&#8217; character
when fit=True.  The points not used will be marked with a
&#8216;x&#8217; in the graph.</p>
<ul class="simple">
<li>Skip the lines inside isfile commented with a &#8216;#&#8217;, or with</li>
</ul>
<p>a void first element</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.meanAngle">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">meanAngle</tt><big>(</big><em>q</em>, <em>u</em>, <em>sq</em>, <em>su</em>, <em>estim='wk'</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#meanAngle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.meanAngle" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mean angle and the error propagated</p>
<p>The computation is over QU parameters.</p>
<p>Unbias theta error using &#8216;estim&#8217; estimator:</p>
<blockquote>
<div><blockquote>
<div>if p/sp &lt;= K,   s_theta = psi
otherwise,      s_theta = propagated error</div></blockquote>
<p>where K is given by the estimator related to the
&#8216;estim&#8217; variable:</p>
<blockquote>
<div><ol class="loweralpha">
<li><p class="first">&#8216;ml&#8217; : Maximum Likelihood (K=1.41, psi=51.96)</p>
</li>
<li><p class="first">&#8216;wk&#8217; : Wardle &amp; Kronberg (K=1.0, psi=51.96)</p>
</li>
<li><p class="first">&#8216;&#8217;   : None (K=0, psi=51.96)</p>
</li>
<li><dl class="first docutils">
<dt>&#8216;mts&#8217;: Maier, Tenzer &amp; Santangelo (estimates</dt>
<dd><p class="first last">from Bayesian analysis, psi=61.14)</p>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.meanAngle_star">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">meanAngle_star</tt><big>(</big><em>csvfile, be, obj, filts='ubvri', vfilter=['no-std'], onlyY=False, estim='wk'</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#meanAngle_star"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.meanAngle_star" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the meanAngle for star &#8216;obj&#8217; in field of Be
&#8216;be&#8217; computed in all filters specified in string
format in the variable &#8216;filts&#8217;.</p>
<p>For example, if filts=&#8217;ubv&#8217;, this routine will
compute the mean angle among UBV filters.</p>
<p>Unbias theta error using &#8216;estim&#8217; estimator:</p>
<blockquote>
<div><blockquote>
<div>if p/sp &lt;= K,   s_theta = psi
otherwise,      s_theta = propagated error</div></blockquote>
<p>where K is given by the estimator related to the
&#8216;estim&#8217; variable:</p>
<blockquote>
<div><ol class="loweralpha">
<li><p class="first">&#8216;ml&#8217; : Maximum Likelihood (K=1.41, psi=51.96)</p>
</li>
<li><p class="first">&#8216;wk&#8217; : Wardle &amp; Kronberg (K=1.0, psi=51.96)</p>
</li>
<li><p class="first">&#8216;&#8217;   : None (K=0, psi=51.96)</p>
</li>
<li><dl class="first docutils">
<dt>&#8216;mts&#8217;: Maier, Tenzer &amp; Santangelo (estimates</dt>
<dd><p class="first last">from Bayesian analysis, psi=61.14)</p>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
</div></blockquote>
<p>CONSIDERATIONS:</p>
<ul class="simple">
<li>Operations over QU parameters</li>
<li>Error from standard star is propagated</li>
<li>If estim != &#8216;&#8217; and the final polarization p is
smaller than its uncertainty multiplied by the
estimator factor K, the error of theta has the
value 51.96 or 61.14, depending of the model</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.readcsv">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">readcsv</tt><big>(</big><em>csvfile</em>, <em>be</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#readcsv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.readcsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Read lines of Be star <em>be</em> from <em>cvsfile</em> and return a
list with all components:</p>
<dl class="docutils">
<dt>[</dt>
<dd><dl class="first last docutils">
<dt>[[star 1, filter 1],</dt>
<dd><dl class="first last docutils">
<dt>[star 1, filter 2]],</dt>
<dd><dl class="first last docutils">
<dt>[[star 2, filter 1],</dt>
<dd><dl class="first last docutils">
<dt>[star 2, filter 2]],</dt>
<dd><dl class="first last docutils">
<dt>...</dt>
<dd>]</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p>Ignores the observations with &#8216;E&#8217; flag.</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.rotQU">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">rotQU</tt><big>(</big><em>q</em>, <em>u</em>, <em>sq</em>, <em>su</em>, <em>ang</em>, <em>sang</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#rotQU"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.rotQU" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates lists/arrays q and u in QU diagram at an angle
2*(ang +- sang) (clockwise).</p>
<p>Look that if &#8216;ang&#8217; is the mean polarization angle,
this rotation will transpose all polarization to
Q parameter. U parameter will have residual variations
with respect to the 0.</p>
<p>Return q_rot, u_rot, sq_rot, su_rot</p>
<p>Todo: sometimes it&#8217;s better don&#8217;t use any error value
for ang?</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.rotQUBe">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">rotQUBe</tt><big>(</big><em>be, thetfile, path=None, every=False, vfilter=['no-std']</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#rotQUBe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.rotQUBe" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates the QU values for Be star &#8216;be&#8217; in the intrinsic
angle specified inside thetfile and computes the &lt;Q&#8217;&gt;
and &lt;U&#8217;&gt; of parameters rotated, returning four lists:
lbd (the wavelength values), &lt;U&#8217;&gt;, sigma U&#8217; and stddev U&#8217;,
with the values in each one of the filters UBVRI.</p>
<dl class="docutils">
<dt>&#8216;thetfile&#8217; <span class="classifier-delimiter">:</span> <span class="classifier">the location (path+filename) of thet_int.csv</span></dt>
<dd>file with the intrinsic angles (out from fs.gen).</dd>
<dt>&#8216;path&#8217; <span class="classifier-delimiter">:</span> <span class="classifier">the path where is located the log file for star</span></dt>
<dd>&#8216;be&#8217;. If None, is supposed inside &#8216;.&#8217;.</dd>
<dt>&#8216;every&#8217; <span class="classifier-delimiter">:</span> <span class="classifier">use one intrinsic angle for each one filter to</span></dt>
<dd>rotate them? If every=False makes all data to use
a mean value at the -4:-2 collums (22th to 24th)
from &#8216;thetfile&#8217;.</dd>
</dl>
<p>CONSIDERATIONS:</p>
<ul class="simple">
<li>Propagates errors from standard star.</li>
</ul>
<p>The rotated parameters are just the polarization
components perpendicular and parallel to the
orientation of the disk.</p>
<p>If every==True, uses the intrinsic angle of each filter to
rotate its QU values (if some angle==0, skip this filter!);
otherwise, use the same value specified in last 4 columns
for every one of the 5 filters.</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.fieldstars.unbiasData">
<tt class="descclassname">pyhdust.fieldstars.</tt><tt class="descname">unbiasData</tt><big>(</big><em>p</em>, <em>s</em>, <em>estim='wk'</em><big>)</big><a class="reference internal" href="_modules/pyhdust/fieldstars.html#unbiasData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.fieldstars.unbiasData" title="Permalink to this definition">¶</a></dt>
<dd><p>Unbias P data, appling the operation over input
lists/arrays:</p>
<p>p^2 -&gt; p^2 - K^2 s^2</p>
<p>INPUT</p>
<blockquote>
<div><blockquote>
<div>p: % polarization
s: pol error</div></blockquote>
<dl class="docutils">
<dt>estim: estimative model:</dt>
<dd><ol class="first last loweralpha simple">
<li>&#8216;ml&#8217;: Maximum Likelihood (K=1.41)</li>
<li>&#8216;wk&#8217;: Wardle &amp; Kronberg (K=1.0)</li>
</ol>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="beatlas.html"
                        title="previous chapter"><strong>beatlas</strong>: module of BeAtlas tools</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="hdrpil.html"
                        title="next chapter"><em>hdrpil</em>: auxiliary module to apply HDR to images</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/fieldstars.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hdrpil.html" title="hdrpil: auxiliary module to apply HDR to images"
             >next</a> |</li>
        <li class="right" >
          <a href="beatlas.html" title="beatlas: module of BeAtlas tools"
             >previous</a> |</li>
        <li><a href="index.html">Python tools for the BeACoN group Beta documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015-2016, D. Moser.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>