<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>images: module of image tools &mdash; Python tools for the BeACoN group Beta documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'Beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Python tools for the BeACoN group Beta documentation" href="index.html" />
    <link rel="next" title="input: module of Hdust input tools" href="input.html" />
    <link rel="prev" title="hdrpil: auxiliary module to apply HDR to images" href="hdrpil.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="input.html" title="input: module of Hdust input tools"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="hdrpil.html" title="hdrpil: auxiliary module to apply HDR to images"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Python tools for the BeACoN group Beta documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-pyhdust.images">
<span id="images-module-of-image-tools"></span><h1><strong>images</strong>: module of image tools<a class="headerlink" href="#module-pyhdust.images" title="Permalink to this headline">¶</a></h1>
<p>PyHdust <em>images</em> module: auxiliary images module</p>
<p># ramp yellow
sz = 100
r = _np.arange(sz*sz).reshape((sz,sz))*256./sz/sz
g = _np.arange(sz*sz).reshape((sz,sz))*256./sz/sz
b = _np.zeros((sz,sz))
yramp = _np.dstack((r,g,b)).astype(uint8)</p>
<p>img = PIL.Image.fromarray(yramp)
img.save(&#8216;yrampRGB.jpg&#8217;)</p>
<p>img = PIL.Image.fromarray(rgb2cmyk(yramp), mode=&#8217;CMYK&#8217;)
img.save(&#8216;yrampCMYK.jpg&#8217;)</p>
<p># convert &#8216;CMYK_color&#8217;
CM = PIL.Image.open(&#8216;CMYK_color.jpg&#8217;)
CM = CM.convert(mode=&#8217;RGB&#8217;)
CM.save(&#8216;CMYK2rgbPIL.jpg&#8217;)</p>
<p>img = PIL.Image.fromarray(rgb2cmyk(_np.asarray(CM)), mode=&#8217;CMYK&#8217;)
img.save(&#8216;CMYK2rgb.jpg&#8217;)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">license:</th><td class="field-body">GNU GPL v3.0 <a class="reference external" href="https://github.com/danmoser/pyhdust/blob/master/LICENSE">https://github.com/danmoser/pyhdust/blob/master/LICENSE</a></td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="pyhdust.images.align_backfore">
<tt class="descclassname">pyhdust.images.</tt><tt class="descname">align_backfore</tt><big>(</big><em>bkimg, frimg, pos=[0.1, 0.9]</em><big>)</big><a class="reference internal" href="_modules/pyhdust/images.html#align_backfore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.images.align_backfore" title="Permalink to this definition">¶</a></dt>
<dd><p>doc</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.images.doColorConv">
<tt class="descclassname">pyhdust.images.</tt><tt class="descname">doColorConv</tt><big>(</big><em>lbd</em>, <em>flx</em>, <em>fdat=None</em><big>)</big><a class="reference internal" href="_modules/pyhdust/images.html#doColorConv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.images.doColorConv" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>fdat</cite> is and (3,nlbd) matrix with the color space functions. If <cite>None</cite>,
CIE 1931 RGB color space is used.</p>
<p>INPUT = lambda (nm), flux (intensities) vectors</p>
<p>OUTPUT = RGB values (0-255; uint8)</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.images.doColorConvMaps">
<tt class="descclassname">pyhdust.images.</tt><tt class="descname">doColorConvMaps</tt><big>(</big><em>data</em>, <em>lbdc</em>, <em>fdat=None</em>, <em>di=0</em>, <em>oi=0</em>, <em>ii=0</em>, <em>outflt=False</em><big>)</big><a class="reference internal" href="_modules/pyhdust/images.html#doColorConvMaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.images.doColorConvMaps" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>fdat</cite> is and (3,nlbd) matrix with the color space functions. If <cite>None</cite>,
CIE 1931 RGB color space is used.</p>
<p><cite>di, oi, ii</cite> are data[oi, ii, di]. <cite>di</cite> = 0 for <a href="#id1"><span class="problematic" id="id2">*</span></a>.maps files.</p>
<p>outflt=True, the output is in float format.</p>
<p>INPUT = data (n,m,nlbdc), lambda (nlbdc; um unit)</p>
<p>OUTPUT = RGB images (n,m,3; [0-255; uint8])</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.images.doHDR">
<tt class="descclassname">pyhdust.images.</tt><tt class="descname">doHDR</tt><big>(</big><em>RGB, levels=6, folder='hdr', ext='png', strength=[1.0], naturalness=[1.0], size=None</em><big>)</big><a class="reference internal" href="_modules/pyhdust/images.html#doHDR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.images.doHDR" title="Permalink to this definition">¶</a></dt>
<dd><p>Do HDR of RGB images.</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.images.do_background">
<tt class="descclassname">pyhdust.images.</tt><tt class="descname">do_background</tt><big>(</big><em>foreimg, backimg, savename=None, pos=[0.1, 0.9], cut=0.5, fmt=['png'], bga=0.9, rotang=0.0, fsize=None</em><big>)</big><a class="reference internal" href="_modules/pyhdust/images.html#do_background"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.images.do_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Add <cite>backimg</cite> as background (bg) of <cite>foreimg</cite> (fg). <cite>*img</cite> are regular
image files (e.g., JPG or PNG).</p>
<p><cite>pos</cite> is the position of the central pixel of fg as fraction size of the 
bg image. Example: 
pos = [.1, .1] puts the foreground image in the lowe left position; 
pos = [.5, .5] in the center.</p>
<p><cite>cut</cite> = limit the brightest pixels. <cite>cut == 1</cite> says that only white points 
will have no background (transparency. In other words, all fg will be 
transparent as bg). 
<cite>cut == 0.5</cite> says that every pixel with &gt;= 50% of the white level will not  
be transparent. <cite>cut == 0</cite> says that all black points will not be 
transparent (i.e., no bg).</p>
<p><cite>bga</cite> = background strength</p>
<p>METHOD: There the fg is brillhant (star), no bg. Where it is tenous, 
(disk), it is applied a combination of bg + fg with the transparency 
is proportiona to the fg brightness.</p>
<p>Is it important to note that even if a &#8220;black background&#8221; is applied, the 
disk will be atenuated where it is below the cutting limit.</p>
<p>DETAILS: a combination of images, without saturation (standard level) is 
equal to (img1 + img2 )/2.</p>
<p>Problem 1: the star becomes transparent! Solution: we define a <cite>cut</cite>, where 
pixels above a given level do not enter in the above sum, rather their 
foreground values are kept.</p>
<p>Problem 2: this procedure can create a big contrast between the star and 
the disk, making the disk 50% fainter. Solucion: define the transparency 
as function of the fg value (bigger the value, less transparent).</p>
<p>Problem 3: if the star is seen edge-on, one can have bg where it is the 
star! How to solve it? Analogous to the <cite>cut</cite>, if an mask can be created 
if the photospheric image is provided (and then, no gb where px_val &gt; 0).</p>
<p>TODO: photospheric mask to cut.</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.images.genGaussian">
<tt class="descclassname">pyhdust.images.</tt><tt class="descname">genGaussian</tt><big>(</big><em>size=64</em>, <em>sig=8</em>, <em>center=(0</em>, <em>0)</em><big>)</big><a class="reference internal" href="_modules/pyhdust/images.html#genGaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.images.genGaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a square gaussian kernel (non-normalized).</p>
<p><cite>size</cite> is the length of a side of the square (pixels)</p>
<p>center is the relative position</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.images.genSquare">
<tt class="descclassname">pyhdust.images.</tt><tt class="descname">genSquare</tt><big>(</big><em>size=64</em>, <em>halfside=16</em>, <em>center=(0</em>, <em>0)</em><big>)</big><a class="reference internal" href="_modules/pyhdust/images.html#genSquare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.images.genSquare" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a square inside a square.</p>
<p>If size is not even, the unit square will not be centered.</p>
<p>center is the relative position</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.images.rgb2cmyk">
<tt class="descclassname">pyhdust.images.</tt><tt class="descname">rgb2cmyk</tt><big>(</big><em>img</em><big>)</big><a class="reference internal" href="_modules/pyhdust/images.html#rgb2cmyk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.images.rgb2cmyk" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>img</cite> must have (m,n,3) dimensions</p>
<p>R&#8217; = R/255</p>
<p>G&#8217; = G/255</p>
<p>B&#8217; = B/255</p>
<p>The black key (K) color is calculated from the red (R&#8217;), green (G&#8217;) and 
blue (B&#8217;) colors:</p>
<p>K = min(R&#8217;, G&#8217;, B&#8217;)</p>
<p>The cyan color (C) is calculated from the red (R&#8217;) and black (K) colors:</p>
<p>C = (1-R&#8217;-K) / (1-K)</p>
<p>The magenta color (M) is calculated from the green (G&#8217;) and black (K) 
colors:</p>
<p>M = (1-G&#8217;-K) / (1-K)</p>
<p>The yellow color (Y) is calculated from the blue (B&#8217;) and black (K) colors:</p>
<p>Y = (1-B&#8217;-K) / (1-K)</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.images.rgb2png">
<tt class="descclassname">pyhdust.images.</tt><tt class="descname">rgb2png</tt><big>(</big><em>RGB</em>, <em>savename=None</em>, <em>ext='png'</em>, <em>size=None</em><big>)</big><a class="reference internal" href="_modules/pyhdust/images.html#rgb2png"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.images.rgb2png" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a array(n,m,3; uint8) as regular image file.</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.images.rotate_coords">
<tt class="descclassname">pyhdust.images.</tt><tt class="descname">rotate_coords</tt><big>(</big><em>x</em>, <em>y</em>, <em>theta</em>, <em>ox</em>, <em>oy</em><big>)</big><a class="reference internal" href="_modules/pyhdust/images.html#rotate_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.images.rotate_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate arrays of coordinates x and y by theta radians about the
point (ox, oy).</p>
<p>This routine was inspired on a <a class="reference external" href="http://codereview.stackexchange.com">http://codereview.stackexchange.com</a> post.</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.images.rotate_cube">
<tt class="descclassname">pyhdust.images.</tt><tt class="descname">rotate_cube</tt><big>(</big><em>src</em>, <em>theta</em>, <em>ox=None</em>, <em>oy=None</em>, <em>fill=0</em><big>)</big><a class="reference internal" href="_modules/pyhdust/images.html#rotate_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.images.rotate_cube" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>src</cite> must be a numpy array.</p>
</dd></dl>

<dl class="function">
<dt id="pyhdust.images.rotate_image">
<tt class="descclassname">pyhdust.images.</tt><tt class="descname">rotate_image</tt><big>(</big><em>src</em>, <em>theta</em>, <em>ox=None</em>, <em>oy=None</em>, <em>fill=0</em><big>)</big><a class="reference internal" href="_modules/pyhdust/images.html#rotate_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyhdust.images.rotate_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the image src by theta radians about (ox, oy).
Pixels in the result that don&#8217;t correspond to pixels in src are
replaced by the value fill.</p>
<p>This routine was inspired on a <a class="reference external" href="http://codereview.stackexchange.com">http://codereview.stackexchange.com</a> post.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="hdrpil.html"
                        title="previous chapter"><em>hdrpil</em>: auxiliary module to apply HDR to images</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="input.html"
                        title="next chapter"><strong>input</strong>: module of <cite>Hdust</cite> input tools</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/images.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="input.html" title="input: module of Hdust input tools"
             >next</a> |</li>
        <li class="right" >
          <a href="hdrpil.html" title="hdrpil: auxiliary module to apply HDR to images"
             >previous</a> |</li>
        <li><a href="index.html">Python tools for the BeACoN group Beta documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015-2016, D. Moser.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>